{"openapi":"3.0.1","info":{"title":"OpenAPI definition","version":"v0"},"servers":[{"url":"http://localhost:47631","description":"Generated server url"}],"tags":[{"name":"登录注册接口","description":"用户登录、注册相关接口"},{"name":"用户相关接口","description":"用户信息、邮箱验证码等接口"},{"name":"获取服务器CPU、内存等信息","description":"获取服务器CPU、内存等信息，仅管理员可用"},{"name":"版本接口","description":"获取服务信息"},{"name":"系统配置接口","description":"系统配置项的增删查改，仅管理员可用"},{"name":"文件管理接口","description":"文件上传、下载和管理接口"},{"name":"聊天消息接口","description":"聊天消息相关接口"}],"paths":{"/user/verifyEmailCode":{"post":{"tags":["用户相关接口"],"summary":"校验邮箱验证码是否正确，需校验用户邮箱和验证码邮箱是否一致","operationId":"verifyEmailCode","parameters":[{"name":"code","in":"query","description":"邮箱验证码","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseVoid"}}}}}}},"/unauth/register":{"post":{"tags":["登录注册接口"],"summary":"用户注册","description":"注册新用户，支持邮箱唯一校验和用户名唯一校验，注册成功返回token","operationId":"register","parameters":[{"name":"username","in":"query","description":"用户名","required":true,"schema":{"type":"string"}},{"name":"password","in":"query","description":"密码","required":true,"schema":{"type":"string"}},{"name":"email","in":"query","description":"邮箱","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringObject"}}}}}}},"/unauth/login":{"post":{"tags":["登录注册接口"],"summary":"用户登录","description":"用户登录，返回token和有效期","operationId":"login","parameters":[{"name":"email","in":"query","description":"邮箱","required":true,"schema":{"type":"string"}},{"name":"password","in":"query","description":"密码","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringObject"}}}}}}},"/file/{id}/public":{"post":{"tags":["文件管理接口"],"summary":"修改文件公开属性","description":"修改文件是否需要登录才能查看","operationId":"updateFilePublicStatus","parameters":[{"name":"id","in":"path","description":"文件ID","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"isPublic","in":"query","description":"是否公开","required":true,"schema":{"type":"boolean"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseFileRecordDTO"}}}}}}},"/file/upload":{"post":{"tags":["文件管理接口"],"summary":"上传文件","description":"上传文件并返回文件链接，默认需要登录才能查看","operationId":"uploadFile","requestBody":{"content":{"application/json":{"schema":{"required":["file"],"type":"object","properties":{"file":{"type":"string","description":"上传的文件","format":"binary"}}}}}},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseFileRecordDTO"}}}}}}},"/config/save":{"post":{"tags":["系统配置接口"],"summary":"批量保存配置项","description":"批量新建或修改配置，接收json对象（key: {value, remark}）","operationId":"saveConfig","requestBody":{"description":"配置项对象，key为配置名，value为对象{value,remark}","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"object","additionalProperties":{"type":"string"}}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseVoid"}}}}}}},"/user/sendEmailCode":{"get":{"tags":["用户相关接口"],"summary":"向用户邮箱发送6位数字验证码","operationId":"sendEmailCode","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseVoid"}}}}}}},"/user/getSelf":{"get":{"tags":["用户相关接口"],"summary":"获取当前登录用户的详细信息","operationId":"getSelf","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUser"}}}}}}},"/unauth/version":{"get":{"tags":["版本接口"],"summary":"获取服务信息","description":"返回服务版本号、服务名称和服务描述","operationId":"getVersion","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseServiceInfo"}}}}}}},"/server/info":{"get":{"tags":["获取服务器CPU、内存等信息"],"summary":"获取服务器信息","description":"获取服务器CPU、内存等信息，仅admin可访问","operationId":"getServerInfo","responses":{"200":{"description":"成功返回服务器信息","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServerInfo"}}}}}}},"/file/public/{id}":{"get":{"tags":["文件管理接口"],"summary":"获取公开文件（无需登录）","description":"根据文件ID获取公开文件，无需登录","operationId":"downloadPublicFile","parameters":[{"name":"id","in":"path","description":"文件ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","format":"binary"}}}}}}},"/file/private/{id}":{"get":{"tags":["文件管理接口"],"summary":"获取文件（需要登录）","description":"根据文件ID获取文件，需要登录","operationId":"privateFile","parameters":[{"name":"id","in":"path","description":"文件ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","format":"binary"}}}}}}},"/file/my-files":{"get":{"tags":["文件管理接口"],"summary":"获取当前用户上传的文件列表","description":"获取当前用户上传的所有文件","operationId":"getCurrentUserFiles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListFileRecordDTO"}}}}}}},"/config/all":{"get":{"tags":["系统配置接口"],"summary":"获取所有配置项","description":"返回所有配置项的key-value和key-remark映射","operationId":"getAllConfig","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringObject"}}}}}}},"/api/messages/before":{"get":{"tags":["聊天消息接口"],"summary":"获取比指定ID小的历史消息","description":"获取比指定ID小的历史消息，最多返回100条，按ID倒序排列","operationId":"getMessagesBeforeId","parameters":[{"name":"id","in":"query","description":"消息ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListChatMessageDTO"}}}}}}},"/api/messages/after":{"get":{"tags":["聊天消息接口"],"summary":"获取比指定ID大的消息","description":"获取比指定ID大的消息，最多返回100条，按ID倒序排列","operationId":"getMessagesAfterId","parameters":[{"name":"id","in":"query","description":"消息ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListChatMessageDTO"}}}}}}},"/config/delete/{key}":{"delete":{"tags":["系统配置接口"],"summary":"删除配置项","description":"根据key删除指定配置项","operationId":"deleteConfig","parameters":[{"name":"key","in":"path","description":"配置项key","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseVoid"}}}}}}}},"components":{"schemas":{"ApiResponseVoid":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"type":"object"}}},"ApiResponseMapStringObject":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"type":"object","additionalProperties":{"type":"object"}}}},"ApiResponseFileRecordDTO":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/FileRecordDTO"}}},"FileRecordDTO":{"type":"object","properties":{"id":{"type":"integer","description":"文件ID","format":"int64"},"originalName":{"type":"string","description":"文件原始名称"},"fileUrl":{"type":"string","description":"文件访问链接"},"fileSize":{"type":"integer","description":"文件大小（字节）","format":"int64"},"contentType":{"type":"string","description":"文件类型"},"requireLogin":{"type":"boolean","description":"是否需要登录才能查看"},"uploaderId":{"type":"integer","description":"上传者用户ID","format":"int64"},"createdAt":{"type":"string","description":"创建时间","format":"date-time"}},"description":"文件记录DTO"},"ApiResponseUser":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/User"}}},"User":{"type":"object","properties":{"id":{"type":"integer","description":"用户ID","format":"int64"},"username":{"type":"string","description":"用户名"},"password":{"type":"string","description":"密码"},"email":{"type":"string","description":"邮箱"},"disabled":{"type":"boolean","description":"停用（true=停用，false=启用）"},"verified":{"type":"boolean","description":"验证（true=已验证，false=未验证）"},"role":{"type":"string","description":"权限（如：admin/user等）"},"createdAt":{"type":"string","description":"创建时间","format":"date-time"},"updatedAt":{"type":"string","description":"更新时间","format":"date-time"},"avatarUrl":{"type":"string","description":"头像URL"}},"description":"用户实体"},"ApiResponseServiceInfo":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/ServiceInfo"}}},"ServiceInfo":{"type":"object","properties":{"version":{"type":"string","description":"服务版本号"},"name":{"type":"string","description":"服务名称"},"description":{"type":"string","description":"服务描述"},"avatarUrl":{"type":"string","description":"服务图标"}},"description":"服务信息实体"},"ServerInfo":{"type":"object","properties":{"osName":{"type":"string","description":"操作系统名称"},"osArch":{"type":"string","description":"操作系统架构"},"osVersion":{"type":"string","description":"操作系统版本"},"availableProcessors":{"type":"integer","description":"可用处理器数","format":"int32"},"cpuLoad":{"type":"number","description":"CPU负载","format":"double"},"freeMemory":{"type":"integer","description":"空闲内存","format":"int64"},"totalMemory":{"type":"integer","description":"总内存","format":"int64"},"maxMemory":{"type":"integer","description":"最大内存","format":"int64"}},"description":"服务器信息实体"},"ApiResponseListFileRecordDTO":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/FileRecordDTO"}}}},"ApiResponseListChatMessageDTO":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/ChatMessageDTO"}}}},"ChatMessageDTO":{"type":"object","properties":{"id":{"type":"integer","description":"消息ID","format":"int64"},"fromId":{"type":"integer","description":"发送者用户ID","format":"int64"},"fromName":{"type":"string","description":"发送者用户名"},"fromAvatar":{"type":"string","description":"发送者头像URL"},"toId":{"type":"integer","description":"接收者用户ID","format":"int64"},"toName":{"type":"string","description":"接收者用户名"},"content":{"type":"string","description":"消息内容"},"timestamp":{"type":"string","description":"时间戳"},"createdAt":{"type":"string","description":"创建时间","format":"date-time"}},"description":"聊天消息DTO"}}}}